# -*- mode: ruby -*-
# vi: set ft=ruby :

# Vagrantfile API/syntax version. 
# Don't touch unless you know what you're doing!
VAGRANTFILE_API_VERSION = "2"

Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  config.vm.box = "debian-minimal"

  # 
  # create several VM's and private networks
  #
  config.vm.define "node-1" do |node|
    node.vm.hostname = "node-1"

    node.vm.network "private_network", ip: "192.168.127.1"
    node.vm.network "forwarded_port", guest: 5000, host: 1234, auto_correct: true

    node.vm.provider "virtualbox" do |vb|
      # Boot with headless mode
      # Use VBoxManage to customize the VM(memory, cpu).
      vb.gui = false
      vb.customize ["modifyvm", :id, "--memory", "256", "--cpus", "1"]
    end

    node.vm.provision "puppet" do |puppet|
      puppet.manifests_path = "manifests"
      puppet.manifest_file  = "default.pp"
      puppet.options = ["--templatedir", "/vagrant/templates"]
    end
  end


  config.vm.define "node-2" do |node|
    node.vm.hostname = "node-2"

    node.vm.network "private_network", ip: "192.168.127.2"
    node.vm.network "forwarded_port", guest: 5000, host: 1234, auto_correct: true

    node.vm.provider "virtualbox" do |vb|
      # Boot with headless mode
      # Use VBoxManage to customize the VM(memory, cpu).
      vb.gui = false
      vb.customize ["modifyvm", :id, "--memory", "256", "--cpus", "1"]
    end

    node.vm.provision "puppet" do |puppet|
      puppet.manifests_path = "manifests"
      puppet.manifest_file  = "default.pp"
      puppet.options = ["--templatedir", "/vagrant/templates"]
    end
  end

end
